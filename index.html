<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <style>
        	*{
        		margin:0;
        		padding:0;
        	}
        	ul,li{
        		list-style:none;
        	}
        	a{
        		text-decoration: none;
        	}
        	.main{
        		width:100%;
        		overflow:hidden;
        	}
        	#main_banner{
        		position:relative;
        		/*background:#CCC;*/
        	}
        	.banner .up_select{
        		position:absolute;
        		bottom: 0px;
        		left: 0;
        		padding:10px 0;
        		width: 100%;
        		height: 40px;
        		background:#000 url(images/up.png) center -6px no-repeat;
        		text-indent:-9999px;
        		opacity:0.1;
        		transition:.3s all ease;
        		cursor:pointer;
                z-index:3;
        	}
        	.banner .up_select:hover{
				opacity: 0.6;
        	}
        	.banner .banner_con{
        		position: relative;
				width:100%;
				height:100%;
        	}

        	/*--翻书效果--*/
	        	.banner .banner_con .book_bg{
	        		position:absolute;
	        		left:0;
	        		top:0;
	        		width:100%;
	        		height: 100%;
	                background: url(images/slide-1.jpg) no-repeat;
	                background-size:100% 100%;
	                z-index: 2;
	        	}
	            /*.banner .banner_con .book_bg:active .page1{
	                -webkit-transform:perspective(800px) rotateY(-180deg);
	            }*/
	        	.banner .banner_con .page1{
	                position: absolute;
	                width: 50%;
	                height: 100%;
	                right: 0;
	                top:0;  	
	                z-index:2;	
	                -webkit-transform-style:preserve-3d;
	                -webkit-transform:perspective(800px) rotateY(0deg);
	                -webkit-transform-origin:left;
	                transition: 1s all ease;
	        	}
	            .banner .banner_con .page1 div{
	                position: absolute;
	                left:0;
	                top:0;
	                width: 100%;
	                height: 100%;
	            }
	        	.banner .banner_con .front{  
	                background: url(images/slide-1.jpg) no-repeat right;
	                background-size:200% 100%;
	                -webkit-transform:translateZ(1px);
	        	}
	            .banner .banner_con .back{  
	                background: url(images/slide-2.jpg) no-repeat;
	                background-size:200% 100%;
	                -webkit-transform:translateZ(-1px) scale(-1,1);
	            }
	            .banner .banner_con .page2{
	                position: absolute;
	                width: 50%;
	                height: 100%;
	                right: 0;
	                top:0;          
	                background: url(images/slide-2.jpg) no-repeat right;
	                background-size: 200% 100%;
	                z-index:1;
	            }
            /*--end 翻书效果--*/

            /*--爆炸效果--*/
	            .banner .banner_con .blast{
	            	position: absolute;
	            	left: 0;
	            	top:0;
	            	width: 100%;
	            	height: 100%;
	            	background:background: url(images/slide-2.jpg) no-repeat;
	            	-webkit-transform-style:preserve-3d;
	            	-webkit-transform:perspective(800px) rotateX(0deg) rotateY(0deg);
	        		z-index: 1;
	            }
	            .banner .banner_con .blast span{
	            	position: absolute;
	            }
            /*--end 爆炸效果--*/

        	.banner_ctl{
        		position:absolute;
        		left:50%;
        		bottom:60px;
				margin-left:-150px;
        		width:300px;
				height:30px;
				z-index:3;
        	}
        	.banner_ctl li{
        		float:left;
        		width: 100px;
        		height: 10px;
        		background:rgba(255,255,255,0.4);
        		margin:0 20px;
        		text-indent:-9999px;
        		cursor:pointer;
        	}
        	.banner_ctl li a{
        		display: block;
        		width: 0;
        		height: 10px;
        		background: rgba(0,0,0,0.4);
        		transition:0.3s all ease;
        	}

			.nav{
				position: relative;
				top:0;
				left: 0;
				width: 100%;
				height: 60px;
				display:-webkit-box;
				background: rgb(27,188,155); 
			}
			.nav li{
				position: relative;
				-webkit-box-flex:1;
				text-align: center;
				font-size:30px;
				line-height: 60px;
				z-index: 2;
				font-family: 'Open Sans', sans-serif;
				font-weight: bold;
				color:#F1F1F1;
				cursor: pointer;
			}
			.nav #block{
				position: absolute;
				left: 0;
				top: 0;
				background: rgba(0,0,0,0.5);
				z-index: 1;
				transition:0.4s all ease;
			}
			.test{
				width: 100%;
				height: 3000px;
				background: #CCC;
			}
        </style>
    </head>
    <body>
    	<div class="main">
    		<div id="main_banner" class="banner">
    			<div class="banner_con">
    				<div class="flip">
    					
    				</div>
    				<div class="book_bg">
                        <div class="page1">
                            <div class="front"></div>
                            <div class="back"></div>
                        </div>
                        <div class="page2"></div>
                    </div>
                    <div class="blast"></div>  
    			</div>
    			<ul class="banner_ctl">
    				<li><a></a></li>
    				<li><a></a></li>
    			</ul>
    			<a id="up_select" class="up_select">加href的话左下角会出现链接提示</a>
    		</div>
    		<ul class="nav">
				<li>Banner</li>
				<li>Portfolio</li>
				<li>Skills</li>
				<li>About Me</li>
				<div id="block"></div>
    		</ul>
    		<div class="test"></div>
    	</div>
    	<script src="js/jquery-1.7.2.js"></script>
    	<script>
    		function rnd(m,n){
    			return Math.floor(m+Math.random()*(n-m));
    		}

    		$(document).ready(function(){

    			//将页面加载和页面刷新的时候scrollTop设置为0
    			$(window).scrollTop(0);
    			window.onbeforeunload=function (){
					if(event.clientX>document.body.clientWidth && event.clientY < 0 || event.altKey){
					}else{
						$(window).scrollTop(0);
					}
				}

    			//将主Banner设置为整屏高度
    			$('#main_banner').css({height:$(window).height()});
    			$(window).resize(function(){
    				$('#main_banner').css({height:$(window).height()});
    			});

    			//添加动画效果的选项卡
    			$bannerCon = $('.banner_con');
    			$bannerTabs = $bannerCon.children();
    			$bannerCtl = $('.banner_ctl');
    			$bannerCtlBtns = $bannerCtl.children();
    			$bannerCtlBtns.click(function(){
    				$(this).children().css({width:'100%'})
    				$(this).siblings().children().css({width:'0'});
    			});


    			//获取翻书元素
    			$bookBg = $('.book_bg');
    			//获取爆炸元素
    			$blast = $('.blast');


				//爆炸初始化
				function blastInit(){
					//行数列数
					var R = 3;
					var C = 7;
					//添加span碎片
					for(var i=0; i<R; i++){
						for(var j=0; j<C; j++){
							$span = $('<span></span>');
							$span.css({width:$blast.outerWidth()/C,height:$blast.outerHeight()/R});
							$span.appendTo('.blast');
							$span.css({left:$span.outerWidth(true)*j,top:$span.outerHeight(true)*i,backgroundImage:'url(images/slide-2.jpg)',backgroundRepeat:'no-repeat',backgroundSize:$span.outerWidth()*C+'px '+$span.outerHeight()*R+'px'});
							$span.css({backgroundPosition:'-'+$span.position().left+'px -'+$span.position().top+'px'});
						}
					}
				}


                //添加翻书效果
				$bannerCtlBtns.eq(0).click(function(){
					//控制z-index
					$blast.css({zIndex:1});
					$bookBg.css({zIndex:2});
					$blast.show();
					$bookPage1 = $('.book_bg .page1');
					// console.log($bookPage1);
					$bookFront = $bookBg.find('.front');
					$bookBack = $bookBg.find('.back');
					$bookPage2 = $('.book_bg .page2');
					//翻过来
					$bookPage1.css({WebkitTransition:'1s all ease'});
					$bookPage1.css({WebkitTransform:'perspective(800px) rotateY(-180deg)'});
					//瞬间回去
					function tranEnd(){
						$bookPage1.off('transitionend',tranEnd);
						$bookPage1.css({WebkitTransition:'none'});
						$bookPage1.css({WebkitTransform:'perspective(800px) rotateY(0deg)'});
						$bookBg.hide();
						$blast.css({zIndex:2});
						$bookBg.css({zIndex:1});
						blastInit();
					}
					$bookPage1.on('transitionend',tranEnd);
				});

				//添加爆炸效果
				$bannerCtlBtns.eq(1).click(function(){
					//控制z-index
					$blast.css({zIndex:2});
					$bookBg.css({zIndex:1});
					$bookBg.show();
					//爆炸初始化执行
					blastInit();
					$aS = $('.blast span');
					$aS.css({WebkitTransition:'1s all ease'});
					//它会每一个都加0.5s,所以延迟很大 刚开始给了22列13行 特别慢
					for(var i=0; i<$aS.length; i++){
						var l = $aS.eq(i).position().left + $aS.eq(i).outerWidth()/2 - $blast.outerWidth()/2;
						var t = $aS.eq(i).position().top + $aS.eq(i).outerHeight()/2 - $blast.outerHeight()/2;
						$aS.eq(i).css({WebkitTransform:'translate('+l+'px,'+t+'px) rotateX('+rnd(-360,360)+'deg) rotateY('+rnd(-360,360)+'deg) scale('+rnd(1,3)+','+rnd(1,3)+')',opacity:0});


						function tranEnd(){
							$aS.eq($aS.length-1).off('transitionend',tranEnd);
							$blast.css({zIndex:1});
							$bookBg.css({zIndex:2});
							$blast.hide();
						}
						$aS.eq($aS.length-1).on('transitionend',tranEnd);
					}
				});

				//more 运动
				//获取向下箭头的按钮
				$down = $('#up_select');
				var t = $(window).scrollTop();
				$down.click(function(){
					$('body,html').animate({scrollTop:t+$('#main_banner').height()},1000,'swing');
				});
    			
    			//吸顶条
    			//滚动事件里判断判断就让nav固定定位 如果小于 就取消定位
    			var navT = $('.nav').offset().top;
    			$(window).scroll(function(){
    				if($(window).scrollTop() >= navT){
	    				$('.nav').css({position:'fixed'});
	    			}else{
	    				$('.nav').css({position:'relative'});
	    			}
    			});

    			//弹性菜单
    			$navLinks = $('.nav li');
    			$('#block').css({width:$navLinks.eq(0).outerWidth(),height:$navLinks.eq(0).outerHeight()});
				for(var i=0;i<$navLinks.length;i++){
					;(function(index){
						$navLinks.eq(index).mouseenter(function(){
							$('#block').css({width:$navLinks.eq(index).outerWidth(),height:$navLinks.eq(index).outerHeight()});
							$('#block').css({left:$(this).position().left});
						});
						$navLinks.eq(index).mouseleave(function(){
							$('#block').css({width:$navLinks.eq(index).outerWidth(),height:$navLinks.eq(index).outerHeight()});
							$('#block').css({left:$(this).position().left});
						});
					})(i);
				}

    		});
    	</script>
    </body>
</html>